((function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B=function(a,b){return function(){return a.apply(b,arguments)}},C={}.hasOwnProperty,D=function(a,b){function d(){this.constructor=a}for(var c in b)C.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};a=function(){function a(){this.onSourceEnded=B(this.onSourceEnded,this),this.onBufferLoaded=B(this.onBufferLoaded,this),this.onRequestLoad=B(this.onRequestLoad,this),this.onRequestProgress=B(this.onRequestProgress,this)}return a.prototype.ctx=null,a.prototype.loaded=null,a.prototype.paused=null,a.prototype.ended=null,a.prototype.startedAt=null,a.prototype.pausedAt=null,a.prototype.duration=null,a.prototype.currentTime=null,a.prototype.playbackRate=1,a.prototype.sourceNode=null,a.prototype.analyserNode=null,a.prototype.buffer=null,a.prototype.values=null,a.prototype.FFT_SIZE=2048,a.prototype.BINS=256,a.EVENT_AUDIO_ENDED="audioEnded",a.EVENT_AUDIO_RESTARTED="audioRestarted",a.SOUND_TEEN_SPIRIT="sound/teen-spirit.mp3",a.prototype.init=function(){var a;return a=window.AudioContext||window.webkitAudioContext,this.ctx=new a,this.values=[],this.duration=this.currentTime=0,this.analyserNode=this.ctx.createAnalyser(),this.analyserNode.smoothingTimeConstant=.9,this.analyserNode.fftSize=this.FFT_SIZE,this.analyserNode.connect(this.ctx.destination),this.load("sound/teen-spirit.mp3")},a.prototype.update=function(){var a,b,c,d,e,f,g,h,i,j;c=new Uint8Array(this.analyserNode.frequencyBinCount),this.analyserNode.getByteFrequencyData(c),f=c.length,b=Math.ceil(f/this.BINS);for(d=h=0,j=this.BINS;0<=j?h<j:h>j;d=0<=j?++h:--h){g=0;for(e=i=0;0<=b?i<b:i>b;e=0<=b?++i:--i)g+=c[d*b+e];a=g/b,this.values[d]=a/256/this.playbackRate}this.loaded&&!this.ended&&(this.currentTime=this.paused?this.pausedAt:Date.now()-this.startedAt,this.currentTime*=this.playbackRate)},a.prototype.load=function(a){var b;return b=new XMLHttpRequest,b.open("GET",a,!0),b.responseType="arraybuffer",b.onprogress=this.onRequestProgress,b.onload=this.onRequestLoad,b.send()},a.prototype.play=function(){return this.ended&&window.dispatchEvent(new Event(a.EVENT_AUDIO_RESTARTED)),this.sourceNode=this.ctx.createBufferSource(),this.sourceNode.onended=this.onSourceEnded,this.sourceNode.connect(this.analyserNode),this.sourceNode.playbackRate.value=this.playbackRate,this.sourceNode.buffer=this.buffer,this.ended=!1,this.paused=!1,this.pausedAt?(this.startedAt=Date.now()-this.pausedAt,this.sourceNode.start(0,this.pausedAt/1e3)):(this.startedAt=Date.now(),this.sourceNode.start(0))},a.prototype.stop=function(){return this.sourceNode.stop(0),this.pausedAt=Date.now()-this.startedAt,this.paused=!0},a.prototype.seek=function(a){if(a===void 0)return;if(a>this.buffer.duration)return;this.ended=!1,this.paused||(this.sourceNode.onended=null,this.sourceNode.stop(0)),this.pausedAt=a*1e3;if(!this.paused)return this.play()},a.prototype.onRequestProgress=function(a){app.view.ui&&app.view.ui.loader.onLoadProgress(a)},a.prototype.onRequestLoad=function(a){app.view.ui&&app.view.ui.loader.onLoadComplete(a),this.ctx.decodeAudioData(a.target.response,this.onBufferLoaded,this.onBufferError)},a.prototype.onBufferLoaded=function(a){return this.buffer=a,app.view.ui.loader.onDecodeComplete(),app.view.ui.player.show(),_gaq.push(["_trackEvent","state","audio-decoded"]),this.loaded=!0,this.duration=this.buffer.duration*1e3*this.playbackRate,this.play()},a.prototype.onBufferError=function(a){return app.view.ui.loader.onError(a)},a.prototype.onSourceEnded=function(b){if(this.paused)return;return this.currentTime=this.duration,this.ended=!0,this.paused=!0,this.pausedAt=0,window.dispatchEvent(new Event(a.EVENT_AUDIO_ENDED))},a}(),c=function(){function b(){this.onAudioRestarted=B(this.onAudioRestarted,this),this.onAudioEnded=B(this.onAudioEnded,this)}return b.prototype.view=null,b.prototype.audio=null,b.prototype.currentTime=null,b.prototype.timeline=null,b.prototype.init=function(){return this.view=app.view,this.audio=app.audio,this.initTimeline(),window.addEventListener(a.EVENT_AUDIO_ENDED,this.onAudioEnded),window.addEventListener(a.EVENT_AUDIO_RESTARTED,this.onAudioRestarted)},b.prototype.initTimeline=function(){return this.currentTime=0,this.timeline=[],this.add(26800,this.view.three.bars,this.view.three.bars.setState,1),this.add(36500,this.view.three.bars,this.view.three.bars.setState,2),this.add(67e3,this.view.three.bars,this.view.three.bars.setState,3),this.add(1e5,this.view.three.bars,this.view.three.bars.setState,4),this.add(116e3,this.view.three.bars,this.view.three.bars.setState,5),this.add(145500,this.view.three.bars,this.view.three.bars.setState,6),this.add(177e3,this.view.three.bars,this.view.three.bars.setState,7),this.add(203e3,this.view.three.bars,this.view.three.bars.setState,8),this.add(220500,this.view.three.bars,this.view.three.bars.setState,9),this.add(115e3,this.view.three.lyrics,this.view.three.lyrics.setState,0),this.add(117e3,this.view.three.lyrics,this.view.three.lyrics.setState,1),this.add(119e3,this.view.three.lyrics,this.view.three.lyrics.setState,2),this.add(137e3,this.view.three.lyrics,this.view.three.lyrics.setState,3),this.add(166e3,this.view.three.lyrics,this.view.three.lyrics.setState,4),this.add(167e3,this.view.three.lyrics,this.view.three.lyrics.setState,5),this.add(6e3,this.view.three,this.view.three.setState,0),this.add(2e4,this.view.three,this.view.three.setState,1),this.add(36500,this.view.three,this.view.three.setState,2),this.add(45e3,this.view.three,this.view.three.setState,3),this.add(5e4,this.view.three,this.view.three.setState,4),this.add(6e4,this.view.three,this.view.three.setState,5),this.add(66e3,this.view.three,this.view.three.setState,6),this.add(71e3,this.view.three,this.view.three.setState,7),this.add(8e4,this.view.three,this.view.three.setState,8),this.add(9e4,this.view.three,this.view.three.setState,9),this.add(1e5,this.view.three,this.view.three.setState,10),this.add(112e3,this.view.three,this.view.three.setState,11),this.add(12e4,this.view.three,this.view.three.setState,12),this.add(127e3,this.view.three,this.view.three.setState,13),this.add(135e3,this.view.three,this.view.three.setState,14),this.add(145e3,this.view.three,this.view.three.setState,15),this.add(167e3,this.view.three,this.view.three.setState,16),this.add(17e4,this.view.three,this.view.three.setState,17),this.add(178e3,this.view.three,this.view.three.setState,18),this.add(19e4,this.view.three,this.view.three.setState,19),this.add(203e3,this.view.three,this.view.three.setState,20),this.add(205e3,this.view.three,this.view.three.setState,21),this.add(220500,this.view.three,this.view.three.setState,22),this.add(235e3,this.view.three,this.view.three.setState,23)},b.prototype.add=function(a,b,c,d){d==null&&(d=null),d!==null&&typeof d!="object"&&(d=[d]),this.timeline.push({caller:b,callback:c,params:d,delay:a}),this.timeline=_.sortBy(this.timeline,"delay")},b.prototype.update=function(){var a,b,c,d,e,f,g;this.currentTime=this.audio.currentTime,a=0,g=this.timeline;for(d=0,f=g.length;d<f;d++){c=g[d];if(c.delay<=this.currentTime){c.callback.apply(c.caller,c.params),a++;continue}break}for(b=e=0;0<=a?e<a:e>a;b=0<=a?++e:--e)this.timeline.shift()},b.prototype.onAudioEnded=function(a){_gaq.push(["_trackEvent","state","end"])},b.prototype.onAudioRestarted=function(a){_gaq.push(["_trackEvent","state","restart"]),this.initTimeline()},b}(),i=function(){function a(a){this.ctx=a,this.view=app.view}return a.prototype.view=null,a.prototype.ctx=null,a.prototype.pos=null,a.prototype.values=null,a.prototype.iSelected=null,a.prototype.eSelected=null,a.prototype.update=function(a,b,c){this.values=a,this.iSelected=b!=null?b:-1,this.eSelected=c!=null?c:-1},a.prototype.draw=function(){var a,b,c,d,e,f,g;c=this.values.length,e=this.view.sketch.height,d=this.view.sketch.width/c-1,a=300,g=[];for(b=f=0;0<=c?f<c:f>c;b=0<=c?++f:--f)this.ctx.fillStyle="rgba(255, 255, 255, 0.1)",b>=this.iSelected&&b<this.eSelected&&(this.ctx.fillStyle="rgba(255, 255, 255, 0.3)"),g.push(this.ctx.fillRect(b*(d+1),e,d,this.values[b]*-a-10));return g},a}(),j=function(){function a(){var a,b;a=new THREE.SphereGeometry(2,16,8),b=new THREE.MeshLambertMaterial({color:255}),this.mesh=new THREE.Mesh(a,b)}return a.prototype.mesh=null,a}(),r=function(){function b(){this.onAudioRestarted=B(this.onAudioRestarted,this),this.onAudioEnded=B(this.onAudioEnded,this),this.el=document.getElementById("loaderUI"),window.addEventListener(a.EVENT_AUDIO_ENDED,this.onAudioEnded),window.addEventListener(a.EVENT_AUDIO_RESTARTED,this.onAudioRestarted)}return b.prototype.el=null,b.prototype.onLoadProgress=function(a){var b;return console.log("onLoadProgress"),b=round(a.loaded/a.total*100),this.el.innerHTML="loading audio... "+b},b.prototype.onLoadComplete=function(a){var b=this;return TweenMax.to(this.el,.3,{alpha:0,onComplete:function(){return b.el.innerHTML="decoding audio... ",TweenMax.to(b.el,.3,{autoAlpha:1})}})},b.prototype.onDecodeComplete=function(){return TweenMax.to(this.el,.3,{autoAlpha:0})},b.prototype.onError=function(a){return this.el.innerHTML="smells like an error"},b.prototype.onAudioEnded=function(a){return this.el.innerHTML='<a href="http://www.mandragoratango.com/" target="_blank">Mandr&aacute;gora Tango - Espiritu Adolescente</a>',TweenMax.to(this.el,.3,{autoAlpha:1})},b.prototype.onAudioRestarted=function(a){return TweenMax.to(this.el,.3,{autoAlpha:0})},b}(),v=function(){function a(a){this.ctx=a,this.touchmove=B(this.touchmove,this),this.touchstart=B(this.touchstart,this),this.show=B(this.show,this),this.view=app.view,this.audio=app.audio,this.alpha=0,this.showAlpha=0,this.over=!1,this.totalWidth=0}return a.prototype.view=null,a.prototype.audio=null,a.prototype.ctx=null,a.prototype.pos=null,a.prototype.totalWidth=null,a.prototype.alpha=null,a.prototype.showAlpha=null,a.prototype.over=null,a.prototype.showed=null,a.BAR_WIDTH=320,a.prototype.show=function(){return this.showed=!0,TweenLite.to(this,.5,{totalWidth:a.BAR_WIDTH,delay:.4,ease:Expo.easeInOut}),TweenLite.to(this,.3,{alpha:.2}),TweenLite.to(this,.3,{showAlpha:.2,delay:.3})},a.prototype.update=function(){!!this.audio.sourceNode},a.prototype.draw=function(){this.pos={x:(this.view.sketch.width-a.BAR_WIDTH)*.5,y:this.view.sketch.height-65},this.ctx.translate(this.pos.x,this.pos.y),this.ctx.beginPath(),this.ctx.rect(0,0,this.totalWidth,1),this.ctx.fillStyle="rgba(255, 255, 255, 0.2)",this.ctx.fill(),this.ctx.closePath(),this.audio.paused?(this.ctx.beginPath(),this.ctx.moveTo(-24,-4),this.ctx.lineTo(-16,0),this.ctx.lineTo(-24,4),this.ctx.lineTo(-24,-4),this.ctx.fillStyle="rgba(255, 255, 255, "+this.alpha+")",this.ctx.fill(),this.ctx.closePath()):(this.ctx.beginPath(),this.ctx.rect(-24,-5,2,10),this.ctx.rect(-19,-5,2,10),this.ctx.fillStyle="rgba(255, 255, 255, "+this.alpha+")",this.ctx.fill(),this.ctx.closePath()),this.audio.duration&&(this.ctx.beginPath(),this.ctx.rect(0,-1,this.audio.currentTime/this.audio.duration*this.totalWidth,2),this.ctx.fillStyle="rgba(255, 255, 255, 0.2)",this.ctx.fill(),this.ctx.closePath()),this.ctx.fillStyle="rgba(255, 255, 255, "+this.showAlpha+")",this.ctx.font="12px Monda",this.ctx.fillText(x.formatTime(this.audio.currentTime,!1),a.BAR_WIDTH+15,4),this.ctx.setTransform(1,0,0,1,0,0)},a.prototype.touchstart=function(){if(!this.showed)return;if(this.over)return this.audio.paused?(this.audio.play(),this.view.resume()):(this.audio.stop(),this.view.pause())},a.prototype.touchmove=function(){var a;if(!this.showed)return;return a=this.view.sketch.touches[0],a.x>this.pos.x-50&&a.x<this.pos.x+10&&a.y>this.pos.y-30&&a.y<this.view.sketch.height?(this.alpha=1,this.over=!0):(this.alpha=.2,this.over=!1)},a}(),g=function(){function a(b,c,d,e,f){this.index=b,this.radius=c!=null?c:30,this.thickness=d!=null?d:3,this.depth=e!=null?e:2,this.segments=f!=null?f:60,this.shape=a.SHAPE_CIRCLE,this.initMesh()}return a.prototype.mesh=null,a.prototype.geometry=null,a.prototype.material=null,a.prototype.index=null,a.prototype.segments=null,a.prototype.radius=null,a.prototype.thickness=null,a.prototype.depth=null,a.prototype.oldValue=null,a.prototype.circ=1,a.prototype.shape=null,a.prototype.scaleX=!1,a.prototype.scaleY=!1,a.prototype.scaleZ=!0,a.prototype.rotateX=!0,a.prototype.rotateY=!0,a.prototype.rotateZ=!0,a.prototype.constRotationZ=0,a.prototype.targetRotationX=null,a.prototype.targetRotationY=null,a.prototype.targetRotationZ=null,a.SHAPE_BAR="bar",a.SHAPE_CIRCLE="circle",a.prototype.initMesh=function(){var a,b,c,d,e,f;d=[],d.push(new THREE.Vector3(this.radius-this.thickness,0,this.depth)),d.push(new THREE.Vector3(this.radius-this.thickness,0,-this.depth)),d.push(new THREE.Vector3(this.radius,0,-this.depth)),d.push(new THREE.Vector3(this.radius,0,this.depth)),d.push(new THREE.Vector3(this.radius-this.thickness,0,this.depth)),this.geometry=new THREE.LatheGeometry(d,this.segments,0,TWO_PI-.001),this.material=new THREE.MeshLambertMaterial({color:16777215,emissive:2236962,ambient:16777215,shininess:100}),this.material.shading=THREE.FlatShading,this.mesh=new THREE.Mesh(this.geometry,this.material),a=this.geometry.faces,c=a.length,f=[];for(b=e=0;e<c;b=e+=8)a[b].a=a[b].b=a[b].c=0,f.push(a[b+1].a=a[b+1].b=a[b+1].c=0);return f},a.prototype.update=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;a==null&&(a=0),this.geometry.verticesNeedUpdate=!0,d=a-this.oldValue,this.targetRotationZ+=a*this.constRotationZ,this.targetRotationX&&(this.targetRotationX+=d),this.targetRotationY&&(this.targetRotationY+=d*2),this.targetRotationZ&&(this.targetRotationZ+=d*2),this.targetRotationX>TWO_PI&&(this.mesh.rotation.x-=TWO_PI,this.targetRotationX-=TWO_PI),this.targetRotationY>TWO_PI&&(this.mesh.rotation.y-=TWO_PI,this.targetRotationY-=TWO_PI),this.targetRotationZ>TWO_PI&&(this.mesh.rotation.z-=TWO_PI,this.targetRotationZ-=TWO_PI),this.rotateX&&(this.mesh.rotation.x+=(this.targetRotationX-this.mesh.rotation.x)*.1),this.rotateY&&(this.mesh.rotation.y+=(this.targetRotationY-this.mesh.rotation.y)*.05),this.rotateZ&&(this.mesh.rotation.z+=(this.targetRotationZ-this.mesh.rotation.z)*.1),a-this.oldValue>.1&&(this.radius+=a),this.oldValue=a,this.scaleX&&(this.mesh.scale.x=a),this.scaleY&&(this.mesh.scale.y=a),this.scaleZ&&(this.mesh.scale.z=a),c=(PI*this.circ+PI-.001)/this.segments,e=a*this.segments,m=this.geometry.vertices,g=m.length;for(f=n=0;n<g;f=n+=4)i=m[f],j=m[f+1],k=m[f+2],l=m[f+3],i.z=l.z=this.depth,j.z=k.z=-this.depth,h=floor(f/4),b=min(h,e)*c,i.x=j.x=cos(b)*(this.radius-this.thickness*this.circ),i.y=j.y=sin(b)*(this.radius-this.thickness)*this.circ+(1-this.circ)*-this.thickness,k.x=l.x=cos(b)*this.radius,k.y=l.y=sin(b)*this.radius*this.circ;return null},a}(),h=function(){function b(){this.onAudioRestarted=B(this.onAudioRestarted,this),this.initContainer(),this.initBars(),this.setState(0),window.addEventListener(a.EVENT_AUDIO_RESTARTED,this.onAudioRestarted)}return b.prototype.container=null,b.prototype.bars=null,b.prototype.updateWithAudio=!0,b.prototype.animationValues=null,b.prototype.initContainer=function(){return this.container=new THREE.Object3D},b.prototype.initBars=function(){var a,b,c,d;this.bars=[],d=[];for(b=c=0;c<10;b=++c)a=new g(b),this.bars.push(a),d.push(this.container.add(a.mesh));return d},b.prototype.update=function(a){var b,c,d,e,f;this.updateWithAudio||(a=this.animationValues),d=this.bars.length;for(c=f=0;0<=d?f<d:f>d;c=0<=d?++f:--f)e=a&&a[c]?a[c]:0,b=this.bars[c],b.update(e)},b.prototype.setState=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C;a==null&&(a=0),e=this.bars.length,a=parseInt(a);switch(a){case 0:t=[];for(d=j=0;0<=e?j<e:j>e;d=0<=e?++j:--j)b=this.bars[d],TweenLite.to(b,.8,{radius:random(38,40),thickness:1,depth:1,circ:1,ease:Quart.easeInOut}),TweenLite.to(b.mesh.position,.8,{z:0}),b.constRotationZ=random(.1),b.targetRotationX=0,b.targetRotationY=random(0,TWO_PI),t.push(b.targetRotationZ=random(0,TWO_PI));return t;case 1:u=[];for(d=k=0;0<=e?k<e:k>e;d=0<=e?++k:--k)b=this.bars[d],i=random(),TweenLite.to(b,1.5,{depth:4,targetRotationX:i*TWO_PI,delay:0,ease:Expo.easeInOut}),u.push(b.scaleZ=!1);return u;case 2:v=[];for(d=l=0;0<=e?l<e:l>e;d=0<=e?++l:--l)b=this.bars[d],i=random(0,TWO_PI),TweenLite.to(b,2.5,{radius:5*d+10,thickness:4,depth:random(15),delay:d/e*.25,ease:Quart.easeInOut}),TweenLite.to(b,d/e*.2+1.5,{targetRotationX:0,targetRotationY:0,targetRotationZ:i,ease:Quart.easeInOut}),TweenLite.to(b.mesh.scale,1,{z:0,onCompleteParams:[b],onComplete:function(a){return a.scaleZ=!0}}),v.push(b.constRotationZ=0);return v;case 3:c=0,f=0;for(d=m=0;0<=e?m<e:m>e;d=0<=e?++m:--m)b=this.bars[d],f=random(1,10),i=random(0,TWO_PI),TweenLite.to(b,.8,{radius:random(30,40),thickness:random(1,6),depth:f,circ:1,targetRotationZ:i,delay:d/e*.1+.3,ease:Quart.easeInOut}),b.mesh.userData.z=c,c+=f+1;w=[];for(d=n=0;0<=e?n<e:n>e;d=0<=e?++n:--n)b=this.bars[d],b.mesh.userData.z-=c*.5,g=b.mesh.userData.z,w.push(TweenLite.to(b.mesh.position,1.5,{z:g,ease:Quart.easeInOut}));return w;case 4:x=[];for(d=o=0;0<=e?o<e:o>e;d=0<=e?++o:--o)b=this.bars[d],x.push(TweenLite.to(b,5,{thickness:d+1,radius:random(30,36)+d,ease:Quart.easeInOut}));return x;case 5:return this.updateWithAudio=!1,this.animationValues=[];case 6:this.updateWithAudio=!0,f=3.2,y=[];for(d=p=0;0<=e?p<e:p>e;d=0<=e?++p:--p)b=this.bars[d],b.radius=30,b.thickness=8,b.depth=1.2,b.circ=0,b.mesh.position.x=-10,b.mesh.position.y=b.thickness*.5,b.mesh.position.z=f*-d+f*e*.5+f*.5,b.mesh.rotation.x=b.mesh.rotation.y=b.mesh.rotation.z=0,b.targetRotationX=b.targetRotationY=b.targetRotationZ=0,b.scaleX=b.scaleY=b.scaleZ=!1,b.constRotationZ=!1,y.push(b.mesh.scale.x=b.mesh.scale.y=b.mesh.scale.z=1);return y;case 7:f=5,z=[];for(d=q=0;0<=e?q<e:q>e;d=0<=e?++q:--q)b=this.bars[d],h=f*-d+f*e*.5+f*.5,TweenLite.to(b,8,{thickness:3,ease:Quart.easeInOut}),z.push(TweenLite.to(b.mesh.position,8,{z:h,ease:Quart.easeInOut}));return z;case 8:A=[];for(d=r=0;0<=e?r<e:r>e;d=0<=e?++r:--r)b=this.bars[d],TweenLite.to(b,1,{radius:random(38,40),thickness:1,depth:2,circ:1,targetRotationX:random(0,PI),targetRotationY:random(0,PI),targetRotationZ:random(0,PI),ease:Quart.easeInOut}),TweenLite.to(b.mesh.position,1,{x:0,y:0,z:0,ease:Quart.easeInOut}),A.push(b.constRotationZ=random(.05));return A;case 9:c=0,f=0;for(d=s=0;0<=e?s<e:s>e;d=0<=e?++s:--s)b=this.bars[d],f=random(5,10),i=random(0,TWO_PI),TweenLite.to(b,.8,{radius:random(30,40),thickness:random(2,6),depth:f,circ:1,delay:d/e*.1,ease:Quart.easeInOut}),TweenLite.to(b,.5,{targetRotationX:0,targetRotationY:0,targetRotationZ:i}),TweenLite.to(b.mesh.scale,.5,{z:.5,delay:.5,onCompleteParams:[b],onComplete:function(a){return a.scaleZ=!0}}),b.mesh.userData.z=c,b.constRotationZ=0,c+=f+1;B=[];for(d=C=0;0<=e?C<e:C>e;d=0<=e?++C:--C)b=this.bars[d],b.mesh.userData.z-=c*.5,g=b.mesh.userData.z,B.push(TweenLite.to(b.mesh.position,1.5,{x:0,y:0,z:g,ease:Quart.easeInOut}));return B}},b.prototype.onAudioRestarted=function(a){var b,c,d,e,f,g;for(c=f=0,g=this.bars.length;0<=g?f<g:f>g;c=0<=g?++f:--f)b=this.bars[c],b.scaleX=b.scaleY=!1,b.scaleZ=!0,b.rotateX=b.rotateY=b.rotateZ=!0,b.constRotationZ=0,b.targetRotationX=d=e=null,b.mesh.position.x=b.mesh.position.y=b.mesh.position.z=0,b.mesh.rotation.x=b.mesh.rotation.y=b.mesh.rotation.z=0;this.setState(0)},b}(),A=function(){function a(a,b,c,d,e){this.index=a,this.radius=b!=null?b:30,this.thickness=c!=null?c:3,this.depth=d!=null?d:2,this.segments=e!=null?e:60,this.shape=g.SHAPE_CIRCLE,this.initMesh()}return a.prototype.mesh=null,a.prototype.geometry=null,a.prototype.material=null,a.prototype.index=null,a.prototype.segments=null,a.prototype.radius=null,a.prototype.thickness=null,a.prototype.depth=null,a.prototype.oldValue=null,a.prototype.circ=1,a.prototype.shape=null,a.prototype.scaleX=!1,a.prototype.scaleY=!1,a.prototype.scaleZ=!0,a.prototype.constRotationZ=0,a.prototype.targetRotationX=null,a.prototype.targetRotationY=null,a.prototype.targetRotationZ=null,a.SHAPE_BAR="bar",a.SHAPE_CIRCLE="circle",a.prototype.initMesh=function(){var a,b,c,d,e,f;d=[],d.push(new THREE.Vector3(this.radius-this.thickness,0,this.depth)),d.push(new THREE.Vector3(this.radius-this.thickness,0,-this.depth)),d.push(new THREE.Vector3(this.radius,0,-this.depth)),d.push(new THREE.Vector3(this.radius,0,this.depth)),d.push(new THREE.Vector3(this.radius-this.thickness,0,this.depth)),this.geometry=new THREE.LatheGeometry(d,this.segments,0,TWO_PI-.001),this.material=new THREE.MeshLambertMaterial({color:16711680,emissive:2236962,ambient:16777215,shininess:100}),this.material.shading=THREE.FlatShading,this.mesh=new THREE.Mesh(this.geometry,this.material),a=this.geometry.faces,c=a.length,f=[];for(b=e=0;e<c;b=e+=8)a[b].a=a[b].b=a[b].c=0,f.push(a[b+1].a=a[b+1].b=a[b+1].c=0);return f},a.prototype.update=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;a==null&&(a=0),this.geometry.verticesNeedUpdate=!0,d=a-this.oldValue,this.targetRotationZ+=a*this.constRotationZ,this.targetRotationX&&(this.targetRotationX+=d),this.targetRotationY&&(this.targetRotationY+=d*2),this.targetRotationZ&&(this.targetRotationZ+=d*2),this.targetRotationX>TWO_PI&&(this.mesh.rotation.x-=TWO_PI,this.targetRotationX-=TWO_PI),this.targetRotationY>TWO_PI&&(this.mesh.rotation.y-=TWO_PI,this.targetRotationY-=TWO_PI),this.targetRotationZ>TWO_PI&&(this.mesh.rotation.z-=TWO_PI,this.targetRotationZ-=TWO_PI),this.mesh.rotation.x+=(this.targetRotationX-this.mesh.rotation.x)*.1,this.mesh.rotation.y+=(this.targetRotationY-this.mesh.rotation.y)*.05,this.mesh.rotation.z+=(this.targetRotationZ-this.mesh.rotation.z)*.1,a-this.oldValue>.1&&(this.radius+=a),this.oldValue=a,this.scaleX&&(this.mesh.scale.x=a),this.scaleY&&(this.mesh.scale.y=a),this.scaleZ&&(this.mesh.scale.z=a),c=(PI*this.circ+PI-.001)/this.segments,e=a*this.segments,m=this.geometry.vertices,g=m.length;for(f=n=0;n<g;f=n+=4)i=m[f],j=m[f+1],k=m[f+2],l=m[f+3],i.z=l.z=this.depth,j.z=k.z=-this.depth,h=floor(f/4),b=min(h,e)*c,i.x=j.x=cos(b)*(this.radius-this.thickness*this.circ),i.y=j.y=sin(b)*(this.radius-this.thickness)*this.circ+(1-this.circ)*-this.thickness,k.x=l.x=cos(b)*this.radius,k.y=l.y=sin(b)*this.radius*this.circ;return null},a}(),k=function(){function a(){var a,b,c,d,e;this.segments=24,this.radius=50,this.thickness=4,this.depth=5,d=[],d.push(new THREE.Vector3(this.radius-this.thickness,0,this.depth)),d.push(new THREE.Vector3(this.radius-this.thickness,0,-this.depth)),d.push(new THREE.Vector3(this.radius,0,-this.depth)),d.push(new THREE.Vector3(this.radius,0,this.depth)),d.push(new THREE.Vector3(this.radius-this.thickness,0,this.depth)),this.geometry=new THREE.LatheGeometry(d,this.segments,0,TWO_PI-.01),this.material=new THREE.MeshPhongMaterial({color:16711680,emissive:2236962,ambient:16777215,shininess:100}),this.material.shading=THREE.FlatShading,this.mesh=new THREE.Mesh(this.geometry,this.material),a=this.geometry.faces,c=a.length;for(b=e=0;e<c;b=e+=8)a[b].a=a[b].b=a[b].c=0,a[b+1].a=a[b+1].b=a[b+1].c=0}return a.prototype.mesh=null,a.prototype.geometry=null,a.prototype.material=null,a.prototype.segments=null,a.prototype.radius=null,a.prototype.thickness=null,a.prototype.depth=null,a.prototype.update=function(a){var b,c,d,e,f,g,h,i,j,k,l,m;a==null&&(a=1),this.geometry.verticesNeedUpdate=!0,c=(TWO_PI-.01)/this.segments,d=a*this.segments,l=this.geometry.vertices,f=l.length;for(e=m=0;m<f;e=m+=4)h=l[e],i=l[e+1],j=l[e+2],k=l[e+3],g=floor(e/4),b=min(g,d)*c,h.x=i.x=cos(b)*(this.radius-this.thickness),h.y=i.y=sin(b)*(this.radius-this.thickness),j.x=k.x=cos(b)*this.radius,j.y=k.y=sin(b)*this.radius;return null},a}(),u=function(){function a(){this.w=10,this.h=100,this.segmentsW=1,this.segmentsH=5,this.hseg=this.h/this.segmentsH,this.geometry=new THREE.PlaneGeometry(this.w,this.h,this.segmentsW,this.segmentsH),this.material=new THREE.MeshBasicMaterial({color:4473924,wireframe:!0}),this.mesh=new THREE.Mesh(this.geometry,this.material)}return a.prototype.mesh=null,a.prototype.geometry=null,a.prototype.material=null,a.prototype.w=null,a.prototype.h=null,a.prototype.segmentsW=null,a.prototype.segmentsH=null,a.prototype.hseg=null,a.prototype.update=function(a){var b,c,d,e,f,g,h,i;a==null&&(a=1),this.geometry.verticesNeedUpdate=!0,b=a*this.segmentsH,g=this.geometry.vertices,d=g.length;for(c=i=0;0<=d?i<d:i>d;c=0<=d?++i:--i)f=g[c],e=floor(c/(this.segmentsW+1)),h=min(e,b)*this.hseg,f.y=this.h*.5-h;return null},a}(),w=function(){function a(){var a,b,c,d,e,f,g,h,i,j,k,l;this.w=10,this.h=100,this.segmentsW=1,this.segmentsH=5,this.hseg=this.h/this.segmentsH,d=[],f=25,e=50,h=2,b=TWO_PI/(f+1);for(c=k=0;0<=f?k<=f:k>=f;c=0<=f?++k:--k)a=b*c,d.push(new THREE.Vector3(sin(a)*(e+h),cos(a)*(e+h),0));for(c=l=f;f<=0?l<=0:l>=0;c=f<=0?++l:--l)a=b*c,i=sin(a)*(e-h),j=cos(a)*(e-h),d.push(new THREE.Vector3(i,j,0));g=new THREE.Shape(d),this.geometry=new THREE.ExtrudeGeometry(g,{bevelEnabled:!1,amount:5}),this.material=new THREE.MeshBasicMaterial({color:4473924,wireframe:!0}),this.mesh=new THREE.Mesh(this.geometry,this.material)}return a.prototype.mesh=null,a.prototype.geometry=null,a.prototype.material=null,a.prototype.w=null,a.prototype.h=null,a.prototype.segmentsW=null,a.prototype.segmentsH=null,a.prototype.hseg=null,a.prototype.update=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;a==null&&(a=1),this.geometry.verticesNeedUpdate=!0,i=20,g=50,j=5,c=TWO_PI/(i+1),d=a*i,l=this.geometry.vertices,f=l.length;for(e=m=0,n=f*.5;0<=n?m<n:m>n;e=0<=n?++m:--m)k=l[e],h=floor(e/this.segmentsW),b=min(h,d)*c,k.x=sin(b)*g,k.y=cos(b)*g;return null},a}(),y=function(){function a(){var a,b,c,d,e,f,g;this.segmentsW=4,this.segmentsH=8,this.hseg=this.h/this.segmentsH,d=[],this.radius=50,b=TWO_PI/this.segmentsH;for(c=f=0,g=this.segmentsH;0<=g?f<=g:f>=g;c=0<=g?++f:--f)a=b*c,d.push(new THREE.Vector3(sin(a)*this.radius,cos(a)*this.radius,0));e=new THREE.SplineCurve3(d),this.geometry=new THREE.TubeGeometry(e,this.segmentsH,5,this.segmentsW),this.material=new THREE.MeshBasicMaterial({color:4473924,wireframe:!0}),this.mesh=new THREE.Mesh(this.geometry,this.material)}return a.prototype.mesh=null,a.prototype.geometry=null,a.prototype.material=null,a.prototype.w=null,a.prototype.h=null,a.prototype.segmentsW=null,a.prototype.segmentsH=null,a.prototype.hseg=null,a.prototype.update=function(a){var b,c,d,e,f,g,h,i,j;a==null&&(a=1),this.geometry.verticesNeedUpdate=!0,c=TWO_PI/this.segmentsH,d=a*this.segmentsH,i=this.geometry.vertices,f=i.length;for(e=j=0;0<=f?j<f:j>f;e=0<=f?++j:--j)h=i[e],g=floor(e/this.segmentsW),b=min(g,d)*c,h.x=sin(b)*this.radius,h.y=cos(b)*this.radius;return null},a}(),l=function(){function a(){var a,b,c,d;this.container=new THREE.Object3D,this.bars=[],this.rows=[],this.thickness=.6,this.depth=.6,this.initLetter(),d=this.bars;for(b=0,c=d.length;b<c;b++)a=d[b],a.userData={pos:a.position.clone()}}return a.prototype.rows=null,a.prototype.bars=null,a.prototype.width=null,a.prototype.height=null,a.prototype.thickness=null,a.prototype.depth=null,a.prototype.disposed=null,a.prototype.show=function(){var a,b,c,d,e;d=this.bars,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(a.visible=!0);return e},a.prototype.hide=function(){var a,b,c,d,e;d=this.bars,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(a.visible=!1);return e},a.prototype.initLetter=function(){},a.prototype.update=function(a){var b,c,d,e,f,g,h,i;if(this.disposed)return;c=this.depth*.5;for(d=f=0,i=this.rows.length;0<=i?f<i:f>i;d=0<=i?++f:--f){e=this.rows[d];for(g=0,h=e.length;g<h;g++)b=e[g],b.geometry.verticesNeedUpdate=!0,b.scale.z=a[d]*50,b.position.z=c*b.scale.z}},a.prototype.dispose=function(){var a,b,c,d;d=this.container;for(b=0,c=d.length;b<c;b++)a=d[b],a.geometry.dispose(),a.material.dispose();return this.disposed=!0},a}(),m=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.initLetter=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o;this.width=9.6,this.height=16,c=this.width*.5,b=this.height*.5,j=3.6,k=this.width-.4,g=this.width-.8,h=this.width-j,i=this.height/10,e=new THREE.MeshPhongMaterial({color:16777215,emissive:2236962,ambient:16777215,shininess:100});for(d=l=0;l<10;d=++l)d<2?a=new THREE.CubeGeometry(k,this.thickness,this.depth):d>3&&d<6?a=new THREE.CubeGeometry(g,this.thickness,this.depth):d>7?a=new THREE.CubeGeometry(this.width,this.thickness,this.depth):a=new THREE.CubeGeometry(j,this.thickness,this.depth),f=new THREE.Mesh(a,e),f.position.y=d*-i,f.position.x-=(this.width-a.width)*.5,f.position.y+=b-a.height,this.container.add(f),this.bars.push(f);o=[];for(d=m=0,n=this.bars.length;0<=n?m<n:m>n;d=0<=n?++m:--m)o.push(this.rows[d]=[this.bars[d]]);return o},b}(l),n=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.initLetter=function(){var a,b,c,d,e,f,g,h,i,j,k;this.width=13.8,this.height=16,c=this.width*.5,b=this.height*.5,i=3.6,g=this.width-i,h=this.height/10,e=new THREE.MeshPhongMaterial({color:16777215,emissive:2236962,ambient:16777215,shininess:100});for(d=j=0;j<16;d=++j)a=new THREE.CubeGeometry(i,this.thickness,this.depth),f=new THREE.Mesh(a,e),d<4?f.position.y=d*-h:d<8?f.position.y=d*-h-h*2:d<12?(f.position.x=g,f.position.y=(d-8)*-h):(f.position.x=g,f.position.y=(d-8)*-h-h*2),f.position.x-=(this.width-a.width)*.5,f.position.y+=b-a.height,this.container.add(f),this.bars.push(f);for(d=k=0;k<2;d=++k)a=new THREE.CubeGeometry(this.width,this.thickness,this.depth),f=new THREE.Mesh(a,e),f.position.y=-h*(4+d),f.position.y+=b-a.height,this.container.add(f),this.bars.push(f);return this.rows[0]=[this.bars[0],this.bars[8]],this.rows[1]=[this.bars[1],this.bars[9]],this.rows[2]=[this.bars[2],this.bars[10]],this.rows[3]=[this.bars[3],this.bars[11]],this.rows[4]=[this.bars[16]],this.rows[5]=[this.bars[17]],this.rows[6]=[this.bars[4],this.bars[12]],this.rows[7]=[this.bars[5],this.bars[13]],this.rows[8]=[this.bars[6],this.bars[14]],this.rows[9]=[this.bars[7],this.bars[15]]},b}(l),o=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.initLetter=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;this.width=9.6,this.height=16,c=this.width*.5,b=this.height*.5,i=3.6,g=this.width-i,h=this.height/10,e=new THREE.MeshPhongMaterial({color:16777215,emissive:2236962,ambient:16777215,shininess:100});for(d=j=0;j<10;d=++j)d<8?a=new THREE.CubeGeometry(i,this.thickness,this.depth):a=new THREE.CubeGeometry(this.width,this.thickness,this.depth),f=new THREE.Mesh(a,e),f.position.y=d*-h,f.position.x-=(this.width-a.width)*.5,f.position.y+=b-a.height,this.container.add(f),this.bars.push(f);m=[];for(d=k=0,l=this.bars.length;0<=l?k<l:k>l;d=0<=l?++k:--k)m.push(this.rows[d]=[this.bars[d]]);return m},b}(l),p=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.initLetter=function(){var a,b,c,d,e,f,g,h,i,j,k,l;this.width=13.8,this.height=16,c=this.width*.5,b=this.height*.5,i=3.6,j=this.width-i*2,k=this.width-i,g=this.width-i,h=this.height/10,e=new THREE.MeshPhongMaterial({color:16777215,emissive:2236962,ambient:16777215,shininess:100}),a=new THREE.CubeGeometry(j,this.thickness,this.depth),f=new THREE.Mesh(a,e),f.position.y+=b-a.height,this.container.add(f),this.bars.push(f),a=new THREE.CubeGeometry(k,this.thickness,this.depth),f=new THREE.Mesh(a,e),f.position.y-=h,f.position.y+=b-a.height,this.container.add(f),this.bars.push(f);for(d=l=0;l<12;d=++l)a=new THREE.CubeGeometry(i,this.thickness,this.depth),f=new THREE.Mesh(a,e),d<6?f.position.y=d*-h:(f.position.x=g,f.position.y=(d-6)*-h),f.position.x-=(this.width-a.width)*.5,f.position.y-=h*2,f.position.y+=b-a.height,this.container.add(f),this.bars.push(f);return a=new THREE.CubeGeometry(k,this.thickness,this.depth),f=new THREE.Mesh(a,e),f.position.y-=h*8,f.position.y+=b-a.height,this.container.add(f),this.bars.push(f),a=new THREE.CubeGeometry(j,this.thickness,this.depth),f=new THREE.Mesh(a,e),f.position.y-=h*9,f.position.y+=b-a.height,this.container.add(f),this.bars.push(f),this.rows[0]=[this.bars[0]],this.rows[1]=[this.bars[1]],this.rows[2]=[this.bars[2],this.bars[8]],this.rows[3]=[this.bars[3],this.bars[9]],this.rows[4]=[this.bars[4],this.bars[10]],this.rows[5]=[this.bars[5],this.bars[11]],this.rows[6]=[this.bars[6],this.bars[12]],this.rows[7]=[this.bars[7],this.bars[13]],this.rows[8]=[this.bars[14]],this.rows[9]=[this.bars[15]]},b}(l),q=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return D(b,a),b.prototype.initLetter=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;this.width=17.6,this.height=16,c=this.width*.5,b=this.height*.5,j=3.6,h=this.width-j,i=this.height/10,g=j/10,e=new THREE.MeshPhongMaterial({color:16777215,emissive:2236962,ambient:16777215,shininess:100});for(d=l=0;l<5;d=++l)a=new THREE.CubeGeometry(j,this.thickness,this.depth),f=new THREE.Mesh(a,e),f.position.y=d*-i,f.position.x=d*g,f.position.x-=(this.width-a.width)*.5,f.position.y+=b-a.height,this.container.add(f),this.bars.push(f);for(d=m=0;m<2;d=++m)d===0?k=this.width-g*10:d===1&&(k=this.width-g*12),a=new THREE.CubeGeometry(k,this.thickness,this.depth),f=new THREE.Mesh(a,e),f.position.x=(this.width-a.width)*.5,f.position.y-=i*(d+5),f.position.x-=(this.width-a.width)*.5,f.position.y+=b-a.height,this.container.add(f),this.bars.push(f);for(d=n=0;n<3;d=++n)d===0?k=j+g*4:d===1?k=j+g*2:d===2&&(k=j),a=new THREE.CubeGeometry(k,this.thickness,this.depth),f=new THREE.Mesh(a,e),f.position.x=g*(d+7),f.position.y-=i*(d+7),f.position.x-=(this.width-a.width)*.5,f.position.y+=b-a.height,this.container.add(f),this.bars.push(f);for(d=o=0;o<3;d=++o)d===0?k=j:d===1?k=j+g*2:d===2&&(k=j+g*4),a=new THREE.CubeGeometry(k,this.thickness,this.depth),f=new THREE.Mesh(a,e),f.position.x=(this.width-a.width)*.5,f.position.y-=i*(d+2),f.position.x-=(this.width-a.width)*.5,f.position.y+=b-a.height,this.container.add(f),this.bars.push(f);for(d=p=0;p<5;d=++p)a=new THREE.CubeGeometry(j,this.thickness,this.depth),f=new THREE.Mesh(a,e),f.position.y=d*-i,f.position.x=this.width-a.width-d*g,f.position.x-=(this.width-a.width)*.5,f.position.y+=b-a.height,this.container.add(f),this.bars.push(f);for(d=q=0;q<3;d=++q)d===0?k=j+g*4:d===1?k=j+g*2:d===2&&(k=j),a=new THREE.CubeGeometry(k,this.thickness,this.depth),f=new THREE.Mesh(a,e),f.position.x=this.width*.5+g*(d+3),f.position.y-=i*(d+7),f.position.x-=(this.width-a.width)*.5,f.position.y+=b-a.height,this.container.add(f),this.bars.push(f);return this.rows[0]=[this.bars[0],this.bars[13]],this.rows[1]=[this.bars[1],this.bars[14]],this.rows[2]=[this.bars[2],this.bars[10],this.bars[15]],this.rows[3]=[this.bars[3],this.bars[11],this.bars[16]],this.rows[4]=[this.bars[4],this.bars[12],this.bars[17]],this.rows[5]=[this.bars[5]],this.rows[6]=[this.bars[6]],this.rows[7]=[this.bars[7],this.bars[18]],this.rows[8]=[this.bars[8],this.bars[19]],this.rows[9]=[this.bars[9],this.bars[20]]},b}(l),s=function(){function a(){this.initHello(),this.initHowLow()}return a.prototype.hello=null,a.prototype.howlow=null,a.prototype.wordHello=null,a.prototype.wordHowLow=null,a.prototype.showed=null,a.prototype.setState=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t=this;a==null&&(a=0),a=parseInt(a);switch(a){case 0:o=this.wordHello;for(g=0,k=o.length;g<k;g++)e=o[g],e.show();return this.showed=!0,this.hello.scale=new THREE.Vector3(.01,.01,.01),TweenLite.to(this.hello.scale,2,{x:.25,y:.25,z:.25,ease:Quart.easeInOut}),_gaq.push(["_trackEvent","state","show-hello"]);case 1:p=this.wordHowLow;for(h=0,l=p.length;h<l;h++)e=p[h],e.show();return this.howlow.scale=new THREE.Vector3(2,2,2),this.howlow.position.y=-150,TweenLite.to(this.howlow.position,4,{y:10,ease:Quart.easeInOut});case 2:return TweenLite.to(this.hello.scale,5,{x:.01,y:.01,z:.01,ease:Quart.easeIn,onComplete:function(){var a,b,c;c=t.wordHello;for(a=0,b=c.length;a<b;a++)e=c[a],e.dispose();return t.hello.parent.remove(t.hello)}});case 3:return TweenLite.to(this.howlow.position,4,{y:15,ease:Quart.easeInOut});case 4:q=this.wordHowLow,s=[];for(i=0,m=q.length;i<m;i++)e=q[i],s.push(function(){var a,g,h;h=[];for(d=a=0,g=e.rows.length;0<=g?a<g:a>g;d=0<=g?++a:--a)f=e.rows[d],c=random(),h.push(function(){var a,d,e;e=[];for(d=0,a=f.length;d<a;d++)b=f[d],e.push(TweenLite.to(b.scale,.01,{y:0,delay:c}));return e}());return h}());return s;case 5:r=this.wordHowLow;for(j=0,n=r.length;j<n;j++)e=r[j],e.dispose();return this.howlow.parent.remove(this.howlow),this.showed=!1}},a.prototype.show=function(){var a,b,c,d,e,f,g;f=this.wordHello;for(b=0,d=f.length;b<d;b++)a=f[b],a.show();g=this.wordHowLow;for(c=0,e=g.length;c<e;c++)a=g[c],a.show();return this.hello.scale=new THREE.Vector3(.01,.01,.01),TweenLite.to(this.hello.scale,2,{x:.25,y:.25,z:.25,ease:Quart.easeInOut}),this.howlow.scale=new THREE.Vector3(2,2,2),this.howlow.position.y=-150,TweenLite.to(this.howlow.position,6.5,{y:10,delay:2,ease:Quart.easeInOut})},a.prototype.hide=function(){var a,b,c,d,e;d=this.wordHello,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(a.hide());return e},a.prototype.restart=function(){return this.showed=!1,this.initHello(),this.initHowLow()},a.prototype.initHello=function(){var a,b,c,d,e,f;this.hello=new THREE.Object3D,this.hello.rotation.x=HALF_PI,this.hello.rotation.z=-HALF_PI,this.wordHello=[new n,new m,new o,new o,new p],b=[2,2,2,2,1],this.createWord(this.hello,this.wordHello,b),e=this.wordHello,f=[];for(c=0,d=e.length;c<d;c++)a=e[c],f.push(a.hide());return f},a.prototype.initHowLow=function(){var a,b,c,d,e,f;this.howlow=new THREE.Object3D,this.howlow.rotation.x=HALF_PI,this.howlow.rotation.z=-HALF_PI,this.howlow.position.z=2,this.wordHowLow=[new n,new p,new q,new o,new p,new q],b=[2,2,1,8,1,1],this.createWord(this.howlow,this.wordHowLow,b),e=this.wordHowLow,f=[];for(c=0,d=e.length;c<d;c++)a=e[c],f.push(a.hide());return f},a.prototype.createWord=function(a,b,c){var d,e,f,g,h,i,j,k;f=0;for(d=g=0,i=b.length;0<=i?g<i:g>i;d=0<=i?++g:--g)e=b[d],f+=e.width+c[d],a.add(e.container);k=[];for(d=h=0,j=b.length;0<=j?h<j:h>j;d=0<=j?++h:--h)e=b[d],d?k.push(e.container.position.x=b[d-1].container.position.x+b[d-1].width*.5+e.width*.5+c[d]):k.push(e.container.position.x=f*-0.5+e.width*.5);return k},a.prototype.update=function(a){var b,c,d,e,f,g,h;if(!this.showed)return;g=this.wordHello;for(c=0,e=g.length;c<e;c++)b=g[c],b.update(a);h=this.wordHowLow;for(d=0,f=h.length;d<f;d++)b=h[d],b.update(a)},a}(),z=function(){function a(a,b){this.index=a,this.label=b,this.texture=THREE.ImageUtils.loadTexture("textures/"+this.label+".png"),this.material=new THREE.MeshLambertMaterial({map:this.texture,color:16777215,ambient:7829367,transparent:!0}),this.geometry=new THREE.PlaneGeometry(130,26,2,2),this.mesh=new THREE.Mesh(this.geometry,this.material),this.mesh.scale=new THREE.Vector3(.12,.12,.12),this.mesh.visible=!1}return a.prototype.mesh=null,a.prototype.geometry=null,a.prototype.material=null,a.prototype.index=null,a.prototype.label=null,a}(),b=function(){function b(){this.onAudioRestarted=B(this.onAudioRestarted,this),this.onSlerpUpdate=B(this.onSlerpUpdate,this),this.view=app.view,this.renderer=this.view.renderer,this.mouse=new THREE.Vector2,this.offset=new THREE.Vector3,this.initThree(),this.initObject(),this.initLights(),this.initControls(),window.addEventListener(a.EVENT_AUDIO_RESTARTED,this.onAudioRestarted)}return b.prototype.view=null,b.prototype.camera=null,b.prototype.scene=null,b.prototype.renderer=null,b.prototype.projector=null,b.prototype.controls=null,b.prototype.container=null,b.prototype.plane=null,b.prototype.bars=null,b.prototype.mouse=null,b.prototype.offset=null,b.prototype.selected=null,b.prototype.interactiveObjects=null,b.prototype.lightA=null,b.prototype.lightB=null,b.prototype.lightC=null,b.prototype.lightD=null,b.prototype.iniQ=null,b.prototype.endQ=null,b.prototype.curQ=null,b.prototype.vec3=null,b.prototype.tweenObj=null,b.prototype.cameraPos0=null,b.prototype.cameraUp0=null,b.prototype.cameraZoom=null,b.prototype.initThree=function(){return this.scene=new THREE.Scene,this.projector=new THREE.Projector,this.camera=new THREE.PerspectiveCamera(50,window.innerWidth/window.innerHeight,1,2e3),this.camera.position=new THREE.Vector3(0,0,80),this.cameraPos0=this.camera.position.clone(),this.cameraUp0=this.camera.up.clone(),this.cameraZoom=this.camera.position.z,this.container=new THREE.Object3D,this.scene.add(this.container)},b.prototype.initLights=function(){var a,b;return this.lightA=new THREE.DirectionalLight(16711680),this.lightA.position.set(0,0,10),this.lightA.intensity=1,this.scene.add(this.lightA),this.lightB=new THREE.PointLight(16711680),this.lightB.position.set(0,-50,10),this.scene.add(this.lightB),this.lightC=new THREE.AmbientLight(16777215),this.lightC.visible=!1,this.scene.add(this.lightC),a=new THREE.SphereGeometry(.5,10,10),b=new THREE.MeshBasicMaterial({color:16711680}),this.lightViewA=new THREE.Mesh(a,b),this.lightViewA.position=this.lightA.position,b=new THREE.MeshBasicMaterial({color:16777215}),this.lightViewB=new THREE.Mesh(a,b),this.lightViewB.position=this.lightB.position},b.prototype.initControls=function(){return this.controls=new THREE.TrackballControls(this.camera,this.renderer.domElement),this.controls.target.set(0,0,0),this.controls.rotateSpeed=1,this.controls.zoomSpeed=.8,this.controls.panSpeed=.8,this.controls.noZoom=!1,this.controls.noPan=!1,this.controls.staticMoving=!1,this.controls.dynamicDampingFactor=.15,this.controls.maxDistance=3e3,this.controls.noPan=!0,this.controls.noZoom=!0,this.controls.enabled=!1},b.prototype.initObject=function(){return this.bars=new h,this.bars.container.rotation.x=HALF_PI,this.scene.add(this.bars.container),this.lyrics=new s,this.scene.add(this.lyrics.hello),this.scene.add(this.lyrics.howlow)},b.prototype.initInteractiveObjects=function(){var a;return this.interactiveObjects=[],a=new j,this.interactiveObjects.push(a.mesh)},b.prototype.initPostProcessing=function(){var a,b;return this.dotScreenShader=new THREE.ShaderPass(THREE.DotScreenShader),this.dotScreenShader.uniforms.scale.value=4,this.dotScreenShader.renderToScreen=!0,this.dotMatrixShader=new THREE.ShaderPass(THREE.DotMatrixShader),this.dotMatrixShader.renderToScreen=!0,this.filmShader=new THREE.ShaderPass(THREE.FilmShader),this.filmShader.uniforms.grayscale.value=0,this.filmShader.renderToScreen=!0,b={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat},a=new THREE.WebGLRenderTarget(window.innerWidth,window.innerHeight,b),this.composer=new THREE.EffectComposer(this.renderer,a),this.composer.addPass(new THREE.RenderPass(this.scene,this.camera)),this.composer.addPass(this.filmShader),this.shaderTime=0},b.prototype.update=function(){var a;if(!this.renderer)return;this.controls&&this.controls.update(),a=app.audio.values.slice(this.view.ui.iniBin,this.view.ui.endBin),this.bars.update(a),this.lyrics.update(a),this.lightB.userData.updateWithAudio&&(this.lightB.position.y=t.map(app.audio.values[10],0,1,20,-50))},b.prototype.draw=function(){this.renderer.render(this.scene,this.camera)},b.prototype.setState=function(a){var b;a==null&&(a=0),a=parseInt(a),b=new THREE.Euler,this.endQ=new THREE.Quaternion,this.iniQ=(new THREE.Quaternion).copy(this.camera.quaternion),this.curQ=new THREE.Quaternion,this.vec3=new THREE.Vector3,this.tweenObj={value:0};switch(a){case 0:return TweenLite.to(this,14,{cameraZoom:150,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate});case 1:return this.endQ.setFromEuler(new THREE.Euler(2.2,-0.15,.55)),TweenLite.to(this.tweenObj,8,{value:1,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate}),TweenLite.to(this.lightB.position,5,{y:-50,z:-50,ease:Quart.easeInOut}),_gaq.push(["_trackEvent","state","reveal-sphere"]);case 2:return this.endQ.setFromEuler(new THREE.Euler(2.5,.08,-0.75)),TweenLite.to(this.tweenObj,3,{value:1,ease:Quart.easeInOut,onUpdate:this.onSlerpUpdate}),TweenLite.to(this.lightB.position,3,{y:-50,z:10,ease:Quart.easeInOut});case 3:return this.endQ.setFromEuler(new THREE.Euler(2.35,-0.35,-0.25)),TweenLite.to(this.tweenObj,5,{value:1,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate});case 4:return this.endQ.setFromEuler(new THREE.Euler(2.56,.15,2.99)),TweenLite.to(this.tweenObj,5,{value:1,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate}),TweenLite.to(this.lightA.position,4,{y:0,z:-10,ease:Quart.easeInOut}),TweenLite.to(this.lightB.position,2,{y:10,z:0,delay:1.2,ease:Quart.easeInOut}),TweenLite.to(this,8,{cameraZoom:120,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate});case 5:return this.endQ.setFromEuler(new THREE.Euler(.85,.25,-3)),TweenLite.to(this.tweenObj,6,{value:1,ease:Sine.easeIn,onUpdate:this.onSlerpUpdate}),TweenLite.to(this.lightA,3,{intensity:0,ease:Quart.easeInOut}),TweenLite.to(this.lightB.position,5,{y:-40,z:10,ease:Quart.easeInOut});case 6:return this.endQ.setFromEuler(new THREE.Euler(.46,.4,-3.06)),TweenLite.to(this.tweenObj,5,{value:1,ease:Sine.easeOut,onUpdate:this.onSlerpUpdate}),TweenLite.to(this.lightB.position,5,{y:-40,z:10,ease:Quart.easeInOut}),TweenLite.to(this,6,{cameraZoom:150,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate});case 7:return this.endQ.setFromEuler(new THREE.Euler(2.56,-1.25,-0.98)),TweenLite.to(this.tweenObj,9,{value:1,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate});case 8:return this.endQ.setFromEuler(new THREE.Euler(1.32,-0.88,-1.45)),TweenLite.to(this.tweenObj,10,{value:1,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate}),TweenLite.to(this,6,{cameraZoom:100,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate});case 9:return this.endQ.setFromEuler(new THREE.Euler(1.25,-1.25,-1.48)),TweenLite.to(this.tweenObj,8,{value:1,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate}),TweenLite.to(this,4,{cameraZoom:80,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate}),TweenLite.to(this.lightB.position,5,{y:-50,z:0,ease:Quart.easeInOut});case 10:return this.endQ.setFromEuler(new THREE.Euler(HALF_PI,0,-HALF_PI)),TweenLite.to(this.tweenObj,4,{value:1,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate}),TweenLite.to(this,8,{cameraZoom:120,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate}),this.lightB.userData.updateWithAudio=!0;case 11:return TweenLite.to(this,4,{cameraZoom:18,ease:Back.easeIn,onUpdate:this.onSlerpUpdate}),this.lightB.userData.updateWithAudio=!1;case 12:return TweenLite.to(this,7,{cameraZoom:200,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate});case 13:return this.endQ.setFromEuler(new THREE.Euler(2.46,-0.06,-1.95)),TweenLite.to(this.tweenObj,8,{value:1,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate}),TweenLite.to(this,2,{cameraZoom:40,ease:Quart.easeInOut,delay:3,onUpdate:this.onSlerpUpdate});case 14:return this.endQ.setFromEuler(new THREE.Euler(-3.07,-0.36,-1.54)),TweenLite.to(this.tweenObj,10,{value:1,ease:Sine.easeIn,onUpdate:this.onSlerpUpdate});case 15:return this.endQ.setFromEuler(new THREE.Euler(-1.22,.14,1.3)),TweenLite.to(this.tweenObj,22,{value:1,ease:Sine.easeOut,onUpdate:this.onSlerpUpdate}),TweenLite.to(this.lightB.position,4,{y:6,z:0,ease:Quart.easeInOut});case 16:return this.endQ.setFromEuler(new THREE.Euler(-2.95,0,1.74)),TweenLite.to(this.tweenObj,.1,{value:1,ease:Sine.easeOut,onUpdate:this.onSlerpUpdate}),TweenLite.to(this,.1,{cameraZoom:80,ease:Quart.easeInOut,onUpdate:this.onSlerpUpdate});case 17:return this.endQ.setFromEuler(new THREE.Euler(2.65,-0.55,1.7)),TweenLite.to(this.tweenObj,8,{value:1,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate}),TweenLite.to(this.lightB.position,8,{y:-50,z:-10,ease:Sine.easeInOut});case 18:return this.endQ.setFromEuler(new THREE.Euler(.5,0,2.9)),TweenLite.to(this.tweenObj,12,{value:1,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate});case 19:return this.endQ.setFromEuler(new THREE.Euler(.55,.58,1.33)),TweenLite.to(this.tweenObj,10,{value:1,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate}),TweenLite.to(this,8,{cameraZoom:40,ease:Quart.easeInOut,onUpdate:this.onSlerpUpdate});case 20:return TweenLite.to(this,2,{cameraZoom:130,ease:Quart.easeInOut,onUpdate:this.onSlerpUpdate}),TweenLite.to(this.lightB.position,2,{y:-100,z:0,ease:Sine.easeInOut}),TweenLite.to(this.lightA,2,{intensity:1,ease:Quart.easeInOut});case 21:return this.endQ.setFromEuler(new THREE.Euler(1.9,1.1,.85)),TweenLite.to(this.tweenObj,15,{value:1,ease:Quart.easeInOut,onUpdate:this.onSlerpUpdate});case 22:return this.endQ.setFromEuler(new THREE.Euler(.4,.17,-2.67)),TweenLite.to(this.tweenObj,14.5,{value:1,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate}),TweenLite.to(this,14,{cameraZoom:80,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate}),TweenLite.to(this.lightB.position,2,{y:-20,ease:Sine.easeInOut}),TweenLite.to(this.lightA,2,{intensity:0,ease:Quart.easeInOut});case 23:return this.endQ.setFromEuler(new THREE.Euler(2.6,-0.15,.07)),TweenLite.to(this.tweenObj,18,{value:1,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate}),TweenLite.to(this,15,{cameraZoom:120,ease:Sine.easeInOut,onUpdate:this.onSlerpUpdate}),TweenLite.to(this.lightB.position,8,{y:-50,ease:Sine.easeInOut})}},b.prototype.onSlerpUpdate=function(){THREE.Quaternion.slerp(this.iniQ,this.endQ,this.curQ,this.tweenObj.value),this.vec3.x=this.cameraPos0.x,this.vec3.y=this.cameraPos0.y,this.vec3.z=this.cameraZoom,this.vec3.applyQuaternion(this.curQ),this.camera.position.copy(this.vec3),this.vec3=this.cameraUp0.clone(),this.vec3.applyQuaternion(this.curQ),this.camera.up.copy(this.vec3)},b.prototype.onAudioRestarted=function(a){this.camera.position.copy(this.cameraPos0),this.camera.up.copy(this.cameraUp0),this.cameraZoom=this.camera.position.z,this.lightA.position.set(0,0,10),this.lightB.position.set(0,-50,10),this.lightA.intensity=1,this.lyrics.restart(),this.scene.add(this.lyrics.hello),this.scene.add(this.lyrics.howlow)},b.prototype.resize=function(){if(!this.renderer)return;this.camera.aspect=this.view.sketch.width/this.view.sketch.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.view.sketch.width,this.view.sketch.height),this.hw=this.view.sketch.width*.5,this.hh=this.view.sketch.height*.5},b}(),d=function(){function a(){this.touchmove=B(this.touchmove,this),this.touchstart=B(this.touchstart,this),this.initBarChart=B(this.initBarChart,this),this.view=app.view,this.audio=app.audio,this.barCirc=1,this.barThickness=4,this.barDepth=2,this.morph=this.onMorphClick,this.scene=0,this.cameraFOV=50,this.iniBin=30,this.endBin=60,this.phi=0,this.theta=0,this.lightA_y=0,this.lightA_z=10,this.lightB_y=-50,this.lightB_z=10,this.dotSpacing=10,this.dotScale=4,this.filmSCount=4096,this.filmSIntensity=.05,this.filmNIntensity=.5,this.initCanvas(),this.initPlayer(),this.initLoader(),this.initBarChart()}return a.prototype.view=null,a.prototype.audio=null,a.prototype.stats=null,a.prototype.canvas=null,a.prototype.ctx=null,a.prototype.player=null,a.prototype.loader=null,a.prototype.barChart=null,a.prototype.barCirc=null,a.prototype.barThickness=null,a.prototype.barDepth=null,a.prototype.barWireframe=!1,a.prototype.morph=null,a.prototype.lightA=!0,a.prototype.lightB=!0,a.prototype.lightC=!1,a.prototype.lightD=!0,a.prototype.lightB_y=null,a.prototype.lightB_z=null,a.prototype.lightA_y=null,a.prototype.lightA_z=null,a.prototype.scene=null,a.prototype.iniBin=null,a.prototype.endBin=null,a.prototype.mute=!1,a.prototype.cameraFOV=null,a.prototype.drawBarChart=!1,a.prototype.phi=null,a.prototype.theta=null,a.prototype.dotScale=null,a.prototype.dotSpacing=null,a.prototype.filmSCount=null,a.prototype.filmSIntensity=null,a.prototype.filmNIntensity=null,a.prototype.initGUI=function(){var a,b,c,d,e,f,g,h;return g=new dat.GUI,g.close(),h=this,a=g.addFolder("Bars"),a.add(this,"barCirc",0,1).step(.1).onChange(function(){return h.onBarCircChange()}),a.add(this,"barThickness",1,10).step(.5).onChange(function(){return h.onBarThicknessChange()}),a.add(this,"barDepth",1,10).step(.5).onChange(function(){return h.onBarDepthChange()}),a.add(this,"barWireframe").onChange(function(){return h.onBarWireframeChange()}),b=g.addFolder("Lights"),b.add(this,"lightA").onChange(function(){return h.onLightChange()}),b.add(this,"lightB").onChange(function(){return h.onLightChange()}),b.add(this,"lightC").onChange(function(){return h.onLightChange()}),b.add(this,"lightA_y",-100,100).onChange(function(){return h.onLightChange()}),b.add(this,"lightA_z",-100,100).onChange(function(){return h.onLightChange()}),b.add(this,"lightB_y",-100,100).onChange(function(){return h.onLightChange()}),b.add(this,"lightB_z",-100,100).onChange(function(){return h.onLightChange()}),c=g.addFolder("Scenes"),c.open(),c.add(this,"scene",["0","1","2","3","4","5","6","7"]).onChange(function(){return h.onSceneChange()}),d=g.addFolder("Audio"),d.open(),d.add(this,"iniBin",0,this.audio.BINS).step(1),d.add(this,"endBin",0,this.audio.BINS).step(1),d.add(this,"mute").onChange(function(){return h.onMuteChange()}),e=g.addFolder("Shaders"),e.add(this,"dotSpacing",0,30).onChange(function(){return h.onShaderChange()}),e.add(this,"dotScale",0,10).onChange(function(){return h.onShaderChange()}),e.add(this,"filmSCount",50,1e4).onChange(function(){return h.onShaderChange()}),e.add(this,"filmSIntensity",0,2).onChange(function(){return h.onShaderChange()}),e.add(this,"filmNIntensity",0,2).onChange(function(){return h.onShaderChange()}),f=g.addFolder("Debug"),f.add(this,"drawBarChart"),f.add(this,"phi",-PI,PI).step(.1),f.add(this,"theta",-HALF_PI,HALF_PI).step(.1)},a.prototype.initStats=function(){return this.stats=new Stats,document.body.appendChild(this.stats.domElement)},a.prototype.initCanvas=function(){return this.canvas=document.getElementById("canvasUI"),this.canvas.width=this.view.sketch.width,this.canvas.height=this.view.sketch.height,this.ctx=this.canvas.getContext("2d")},a.prototype.initPlayer=function(){return this.player=new v(this.ctx)},a.prototype.initLoader=function(){return this.loader=new r},a.prototype.initBarChart=function(){return this.barChart=new i(this.ctx)},a.prototype.onBarCircChange=function(){var a,b,c,d,e;d=this.view.three.bars.bars,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(a.circ=this.barCirc);return e},a.prototype.onBarThicknessChange=function(){var a,b,c,d,e;d=this.view.three.bars.bars,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(a.thickness=this.barThickness);return e},a.prototype.onBarDepthChange=function(){var a,b,c,d,e;d=this.view.three.bars.bars,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(a.depth=this.barDepth);return e},a.prototype.onBarWireframeChange=function(){var a,b,c,d,e;d=this.view.three.bars.bars,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(a.material.wireframe=this.barWireframe);return e},a.prototype.onMorphClick=function(){var a,b,c,d,e;d=this.view.three.bars.bars,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],a.circ===1?e.push(TweenLite.to(a,.4,{circ:0})):e.push(TweenLite.to(a,.4,{circ:1}));return e},a.prototype.onLightChange=function(){return this.view.three.lightA.visible=this.lightA,this.view.three.lightB.visible=this.lightB,this.view.three.lightC.visible=this.lightC,this.view.three.lightA.position.y=this.lightA_y,this.view.three.lightA.position.z=this.lightA_z,this.view.three.lightB.position.y=this.lightB_y,this.view.three.lightB.position.z=this.lightB_z},a.prototype.onSceneChange=function(){return this.view.three.bars.setState(this.scene)},a.prototype.onMuteChange=function(){return this.mute?this.audio.analyserNode.disconnect():this.audio.analyserNode.connect(this.audio.ctx.destination)},a.prototype.onCameraChange=function(){return this.view.three.camera.fov=this.cameraFOV,this.view.three.camera.updateProjectionMatrix()},a.prototype.onShaderChange=function(){return this.view.three.filmShader.uniforms.sCount.value=this.filmSCount,this.view.three.filmShader.uniforms.sIntensity.value=this.filmSIntensity,this.view.three.filmShader.uniforms.nIntensity.value=this.filmNIntensity},a.prototype.update=function(){return this.player.update(),this.barChart.update(this.audio.values,this.iniBin,this.endBin)},a.prototype.draw=function(){this.ctx.clearRect(0,0,this.view.sketch.width,this.view.sketch.height),this.player.draw();if(this.drawBarChart)return this.barChart.draw()},a.prototype.resize=function(){return this.canvas.width=this.view.sketch.width,this.canvas.height=this.view.sketch.height},a.prototype.touchstart=function(){return this.player.touchstart()},a.prototype.touchmove=function(){return this.player.touchmove()},a}(),f=function(){function a(){this.resume=B(this.resume,this),this.pause=B(this.pause,this),this.initUI=B(this.initUI,this),this.initThree=B(this.initThree,this),this.initSketch=B(this.initSketch,this)}return a.prototype.audio=null,a.prototype.renderer=null,a.prototype.sketch=null,a.prototype.three=null,a.prototype.ui=null,a.prototype.down=!1,a.prototype.init=function(){return this.audio=app.audio,this.timeline=app.timeline,this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.initSketch(),TweenMax.globalTimeScale(this.audio.playbackRate)},a.prototype.initSketch=function(){var a=this;return this.sketch=Sketch.create({type:Sketch.WEBGL,element:this.renderer.domElement,context:this.renderer.context,autopause:!1}),this.sketch.setup=function(){return a.initThree(),a.initUI(),a.timeline.init()},this.sketch.update=function(){return a.audio.update(),a.three.update(),a.ui.update(),a.timeline.update()},this.sketch.draw=function(){return a.three.draw(),a.ui.draw()},this.sketch.resize=function(){if(!a.three)return;return a.three.resize(),a.ui.resize()},this.sketch.touchstart=function(){return a.down=!0,a.ui.touchstart(),a.audio.ctx.resume()},this.sketch.touchmove=function(){a.ui.touchmove(),!!a.down},this.sketch.touchend=function(){return a.down=!1},this.sketch.keyup=function(b){if(b.keyCode===32)return a.audio.paused?(a.audio.play(),a.resume()):(a.audio.stop(),a.pause())}},a.prototype.initThree=function(){return this.three=new b},a.prototype.initUI=function(){return this.ui=new d},a.prototype.pause=function(){return TweenMax.pauseAll(),this.three.controls.enabled=!0},a.prototype.resume=function(){return TweenMax.resumeAll(),this.three.controls.enabled=!1},a}(),window.app={view:null,audio:null,timeline:null,init:function(){if(!Detector.webgl){Detector.addGetWebGLMessage();return}return app.initAudio(),app.initView(),app.initTimeline(),app.audio.init(),app.view.init()},initAudio:function(){return app.audio=new a},initView:function(){return app.view=new f},initTimeline:function(){return app.timeline=new c}},app.init(),e=function(){function a(){}return a.getSeconds=function(a){var b,c;return a.indexOf(":")<0?0:(b=a.split(":"),b.length===3?c=+b[0]*60*60+ +b[1]*60+ +b[2]:b.length===2?c=+b[0]*60+ +b[1]:c=+b[0],c)},a.mercatorEncode=function(a,b,c){var d,e,f,g;return c==null&&(c=0),a=+a,b=b*Math.PI/180,c||(c=AppData.MAP_SIZE),e=d=c,f=e*(180+a)/360%e,g=Math.log(Math.tan(b*.5+Math.PI*.25)),g=d*.5-e*g/(2*Math.PI),[f,g]},a.getTrainLocationValue=function(a){var b;return b=0,a.indexOf("Between")===0&&(b=.5),b},a.getTrainLastStation=function(a){var b,c,d,e;return b=/Between\s(.+)\sand\s/,c=b.exec(a),c&&(e=c[1]),e||(b=/(At|Approaching|Left|)\s(.+)/,c=b.exec(a),c&&(e=c[2])),e?(d=app.stations.findWhere({name:e}),d?d.get("code"):console.log("AppUtils.getTrainLastStation : stationName "+e+" not found.")):null},a}(),t=function(){function a(){}return a.map=function(a,b,c,d,e,f,g,h){var i,j;return f==null&&(f=!1),g==null&&(g=!0),h==null&&(h=!0),g&&a<b?d:h&&a>c?e:(i=(a-b)/(c-b),j=i*(e-d)+d,f?Math.round(j):j)},a.hexToRgb=function(a){var b,c,d,e,f;return e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a),e?(d=parseInt(e[1],16),c=parseInt(e[2],16),b=parseInt(e[3],16),f=d+", "+c+", "+b,{r:d,g:c,b:b,rgb:f}):null},a.rgbToHex=function(a,b,c){return"#"+((1<<24)+(a<<16)+(b<<8)+c).toString(16).slice(1)},a}(),x=function(){function a(){}return a.addLeadingZero=function(a,b){var c,d,e;b==null&&(b=1),d=String(a);for(c=e=0;0<=b?e<b:e>b;c=0<=b?++e:--e)a<Math.pow(10,c+1)&&a>-1&&(d="0"+d);return d},a.formatTime=function(a,b,c,d,e){var f,g,h,i,j;return b==null&&(b=!0),c==null&&(c=!0),d==null&&(d=!0),e==null&&(e=!1),i=Math.floor(a/1e3),h=Math.floor(i/60),g=Math.floor(h/60),f=Math.floor(a%1e3),j="",b&&(j+=this.addLeadingZero(g)),b&&c&&(j+=":"),c&&(j+=this.addLeadingZero(h%60)),c&&d&&(j+=":"),d&&(j+=this.addLeadingZero(i%60)),d&&e&&(j+="."),e&&(j+=this.addLeadingZero(f,2).substr(0,2)),j},a}()})).call(this)