((function(){var a;requirejs(["toxi/geom/Vec3D","sketch.min","./plugins/ColorPropsPlugin.min","./TimelineMax.min","./TweenLite.min"],function(b){return window.Vec3D=b,window.focus(),a()}),a=function(){var a;return a=Sketch.create({particles:[],colour:null,composite:null,mode:0,body:null,timeline_0:null,timeline_1:null,timeline_2:null,NUM_MODES:3,NUM_PARTICLES:30,DISTANCE:50,DISTANCE_SQ:null,GRAVITY:0,WIND:0,DAMP:.9,COLOURS_0:["rgba(34, 34, 34, 0.1)","rgba(34, 34, 34, 0.5)"],COLOURS_1:["rgba(243, 134, 48, 0.5)","rgba(250, 105, 0, 0.1)","rgba(250, 105, 0, 0.8)","rgba(192, 37, 37, 0.5)"],COLOURS_2:["rgba(105, 195, 231, 0.5)","rgba(64, 147, 255, 0.1)","rgba(64, 147, 255, 0.7)","rgba(27, 60, 100, 0.5)"],THICKNESS:20,SOURCE_OVER:"source-over",LIGHTER:"lighter",container:document.getElementById("container"),autoclear:!1,setup:function(){return this.DISTANCE_SQ=this.DISTANCE*this.DISTANCE,this.colour={},this.colour.c=this.COLOURS_0[0],this.composite=this.SOURCE_OVER,this.body=document.getElementsByTagName("body")[0],this.initParticles(),this.initColours(),this.switchMode()},update:function(){var b,c,d,e,f,g,h,i,j,k,l,m,n;j=this.particles[0],j.x=a.mouse.x,j.y=a.mouse.y;if(!j.x&&!j.y)return;n=[];for(f=l=m=this.NUM_PARTICLES-1;m<=0?l<=0:l>=0;f=m<=0?++l:--l)j=this.particles[f],g=this.particles[f+1],k=this.particles[f-1],f===0?k=j:f===this.NUM_PARTICLES-1&&(g=j),d=k.x-g.x,e=k.y-g.y,j.angle=atan2(e,d)+HALF_PI,j.mx=-j.thickness*cos(j.angle),j.my=-j.thickness*sin(j.angle),j.nx=j.thickness*cos(j.angle),j.ny=j.thickness*sin(j.angle),j.vx*=this.DAMP,j.vy*=this.DAMP,j.x+=j.vx,j.y+=j.vy,h=j.x,i=j.y,d=j.x-k.x,e=j.y-k.y,c=d*d+e*e,c>this.DISTANCE_SQ?(b=atan2(e,d),j.x=k.x+this.DISTANCE*cos(b),j.y=k.y+this.DISTANCE*sin(b),j.vx+=(j.x-h)*.1,n.push(j.vy+=(j.y-i)*.1)):n.push(void 0);return n},draw:function(){var b,c,d,e,f,g,h,i,j,k,l;a.globalCompositeOperation=this.composite,a.beginPath(),a.strokeStyle=this.colour.c,a.fillStyle=a.strokeStyle,a.lineWidth=1,k=this.particles;for(h=0,j=k.length;h<j;h++)f=k[h],a.arc(f.x,f.y,2,0,TWO_PI),a.closePath();a.fill(),a.beginPath();for(b=i=0,l=this.NUM_PARTICLES;0<=l?i<l:i>l;b=0<=l?++i:--i)f=this.particles[b],e=this.particles[b+1],g=this.particles[b-1],b===0?g=f:b===this.NUM_PARTICLES-1&&(e=f),c=f.x+(e.x-f.x)*.5,d=f.y+(e.y-f.y)*.5,this.mode===1?a.bezierCurveTo(g.x+cos(g.angle+HALF_PI)*10,g.y+sin(g.angle+HALF_PI)*10,f.x-cos(f.angle+HALF_PI)*10,f.y-sin(f.angle+HALF_PI)*10,f.x,f.y):this.mode===2?a.bezierCurveTo(g.x+cos(g.angle+HALF_PI)*10,g.y+sin(g.angle+HALF_PI)*10,f.x-cos(e.angle+HALF_PI)*10,f.y-sin(e.angle+HALF_PI)*10,e.x,e.y):(a.bezierCurveTo(f.x+f.mx,f.y+f.my,f.x+f.nx,f.y+f.ny,c,d),a.arc(f.x+f.nx,f.y+f.ny,2,0,TWO_PI));return a.stroke()},keydown:function(){if(a.keys.C)return a.clear();if(a.keys.SPACE)return this.switchMode()},click:function(){},touchend:function(){var b;return b=a.touches[0],this.switchMode()},switchMode:function(){a.clear(),this.mode<this.NUM_MODES-1?this.mode++:this.mode=0;switch(this.mode){case 1:return this.timeline_0.stop(),this.timeline_1.play(),this.timeline_2.stop(),this.body.style.background="#222",parent.app&&parent.app.updateBodyClass(""),this.composite=this.LIGHTER;case 2:return this.timeline_0.stop(),this.timeline_1.stop(),this.colour.c=this.COLOURS_2[0],this.timeline_2.play(),this.body.style.background="#222",parent.app&&parent.app.updateBodyClass(""),this.composite=this.LIGHTER;default:return this.timeline_0.play(),this.timeline_1.stop(),this.timeline_2.stop(),this.colour.c=this.COLOURS_0[0],this.body.style.background="#FFF",parent.app&&parent.app.updateBodyClass("white"),this.composite=this.SOURCE_OVER}},initParticles:function(){var b,c,d,e,f;f=[];for(b=d=0,e=this.NUM_PARTICLES;0<=e?d<e:d>e;b=0<=e?++d:--d)c={x:a.mouse.x,y:a.mouse.y,vx:0,vy:0,angle:0,thickness:0,mx:0,my:0,nx:0,ny:0},b<this.NUM_PARTICLES*.5?c.thickness=this.THICKNESS*(b/this.NUM_PARTICLES):c.thickness=this.THICKNESS*((this.NUM_PARTICLES-b)/this.NUM_PARTICLES),f.push(this.particles.push(c));return f},initColours:function(){var a,b,c,d,e,f,g;this.timeline_0=new TimelineMax({repeat:-1,paused:!0});for(a=b=0,e=this.COLOURS_0.length;0<=e?b<e:b>e;a=0<=e?++b:--b)this.timeline_0.to(this.colour,3,{colorProps:{c:this.COLOURS_0[a]}});this.timeline_0.to(this.colour,3,{colorProps:{c:this.COLOURS_0[0]}}),this.timeline_1=new TimelineMax({repeat:-1,paused:!0});for(a=c=0,f=this.COLOURS_1.length;0<=f?c<f:c>f;a=0<=f?++c:--c)this.timeline_1.to(this.colour,3,{colorProps:{c:this.COLOURS_1[a]}});this.timeline_1.to(this.colour,3,{colorProps:{c:this.COLOURS_1[0]}}),this.timeline_2=new TimelineMax({repeat:-1,paused:!0});for(a=d=0,g=this.COLOURS_2.length;0<=g?d<g:d>g;a=0<=g?++d:--d)this.timeline_2.to(this.colour,3,{colorProps:{c:this.COLOURS_2[a]}});return this.timeline_2.to(this.colour,3,{colorProps:{c:this.COLOURS_2[0]}})}})}})).call(this)